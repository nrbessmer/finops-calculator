<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FinOps++</title>
  <!-- Import Google Font (Roboto Mono) -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <!-- Bootstrap CSS for collapse and layout -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- Custom CSS with techie enhancements -->
  <style>
    body { 
      background: #f7f7f7; 
      font-family: 'Roboto Mono', monospace;
      color: #000;
      padding-bottom: 2rem;
    }
    p, li, label, input, button, textarea { 
      font-weight: 400; 
    }
    a { 
      color: #0000EE; 
      text-decoration: none; 
    }
    a:hover { 
      text-decoration: underline; 
    }
    /* Header styling */
    .header {
      text-align: center;
      padding: 2.5rem 0;
      border-bottom: 3px solid #4a90e2;
      margin-bottom: 2rem;
    }
    .header h1 {
      font-size: 3.5rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 0.5rem;
      font-weight: 700;
      background: linear-gradient(45deg, #4a90e2, #50e3c2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .header p {
      font-size: 1.2rem;
      color: #333;
    }
    /* Card styling */
    .section-card { 
      margin-bottom: 1.5rem; 
      border: 1px solid #ddd;
      background: #fff;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    .card-header { 
      background: linear-gradient(45deg, #4a90e2, #50e3c2);
      color: #fff; 
      cursor: pointer;
      user-select: none;
      text-transform: uppercase;
      font-weight: 700;
      padding: 0.75rem 1.25rem;
      border-bottom: 1px solid #ddd;
      transition: background 0.3s ease;
    }
    .card-header:hover { 
      background: linear-gradient(45deg, #3b7cc4, #3ce0aa);
    }
    .card-body { 
      background: #fff; 
      color: #000;
      padding: 1rem 1.25rem;
    }
    .instruction { 
      font-size: 0.9rem; 
      margin-bottom: 1rem; 
    }
    .form-control {
      background: #fff;
      border: 1px solid #ccc;
      color: #000;
    }
    .form-control:focus {
      background: #fff;
      border-color: #4a90e2;
      box-shadow: none;
      color: #000;
    }
    .btn {
      border: 1px solid #4a90e2;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      background: #4a90e2;
      color: #fff;
      margin-bottom: 1rem;
    }
    footer { 
      text-align: center; 
      padding: 1rem 0; 
      margin-top: 2rem; 
      background: #fff; 
      color: #000;
      border-top: 1px solid #ddd;
      font-size: 0.8rem;
      font-family: Courier, monospace;
    }
    .export-margin { margin-bottom: 12px; }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="container">
    <div class="header">
      <h1>FinOps++</h1>
      <p>Cost Modeling • Live Cloud Pricing • Forecasting • Simulation • Exportable Reports</p>
    </div>
  </div>
  
  <div class="container">
    <!-- Overview Section (Not exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#overviewSection" aria-expanded="true" aria-controls="overviewSection">
        Overview
      </div>
      <div id="overviewSection" class="collapse show">
        <div class="card-body">
          <p>
            Cloud computing has transformed the way businesses operate by providing scalable, on‑demand resources. However, with flexibility comes complexity—dynamic pricing models, tiered discounts, and variable usage patterns can easily lead to unforeseen expenses. FinOps++ is engineered to bring clarity to this complexity by integrating live pricing data (when available) along with fallback values, enabling you to build detailed cost models and forecasts that are essential for strategic budgeting and financial planning.
          </p>
          <p>
            This tool breaks down your overall cloud spending into key components such as compute, storage, network, and licensing. By mirroring real‑world pricing structures, FinOps++ allows you to see how exceeding certain usage thresholds can trigger discount tiers or drive costs upward, providing you with actionable insights.
          </p>
          <p>
            With robust forecasting capabilities, you can project your cloud expenditures over a 12‑month period based on expected growth rates. The platform also includes Monte Carlo simulations to statistically model uncertainty and risk, while sensitivity analysis identifies which variables have the greatest impact on your overall costs.
          </p>
          <p>
            FinOps++ isn’t just a calculator—it’s a comprehensive, interactive platform that educates both IT and finance teams on cloud cost dynamics. Detailed explanations for every variable and a suite of advanced simulation tools empower you to make data‑driven decisions, negotiate better pricing with providers, and proactively manage your budget.
          </p>
          <p>
            Whether you’re a startup deploying your first cloud solution or a large enterprise managing a multi‑cloud strategy, FinOps++ equips you with the insights needed to prevent budget overruns, optimize resource allocation, and improve operational efficiency. It turns reactive cost management into a proactive strategic advantage.
          </p>
        </div>
      </div>
    </div>
    
    <!-- Practical Use Cases Section (Not exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#useCaseSection" aria-expanded="true" aria-controls="useCaseSection">
        Practical Use Cases
      </div>
      <div id="useCaseSection" class="collapse show">
        <div class="card-body">
          <p>
            <strong>Hypothetical Business Scenario:</strong> Imagine you are the CFO of "CloudSavvy Retail," an e‑commerce company that relies on cloud services to host its website, manage customer data, and process transactions. After launching a major marketing campaign, your website experiences a 300% surge in traffic. This sudden spike in demand causes your cloud usage to skyrocket—particularly in compute, storage, and network services—resulting in significant cost overages that threaten to derail your quarterly budget.
          </p>
          <p>
            <strong>Step‑by‑Step Process Using FinOps++:</strong>
          </p>
          <ol>
            <li>
              <strong>Baseline Data Entry:</strong>
              <br>Enter your fixed operational costs (e.g., server management fees and licensing) along with revenue assumptions (average revenue per transaction and expected transaction volume). This establishes your financial baseline.
            </li>
            <li>
              <strong>Detailed Cost Modeling:</strong>
              <br>Input the costs for each cloud service category—compute, storage, network, and licensing—using tiered discount models that mirror your provider’s pricing. This reveals which cost centers are most vulnerable.
            </li>
            <li>
              <strong>Advanced Settings:</strong>
              <br>Configure advanced parameters like the Auto‑Scaling Factor (to lower compute costs when resources scale efficiently) and the Dynamic Pricing Adjustment (to simulate revenue boosts during high‑demand periods). These settings let you test strategies to mitigate overages.
            </li>
            <li>
              <strong>Deterministic Calculation:</strong>
              <br>Run the deterministic calculation to obtain key metrics—total revenue, total cost, profit, profit margin, and ROI. This provides an immediate snapshot of the financial impact.
            </li>
            <li>
              <strong>Forecasting Future Costs:</strong>
              <br>Use the forecasting module to project your cloud costs over the next 12 months based on your expected monthly growth rate. This helps you plan for additional resources or budget adjustments.
            </li>
            <li>
              <strong>Monte Carlo Simulation:</strong>
              <br>Run thousands of simulation iterations to create a probability distribution of potential outcomes. This statistical analysis quantifies risk and aids in setting aside contingency funds.
            </li>
            <li>
              <strong>Sensitivity Analysis:</strong>
              <br>Perform sensitivity analysis on key variables—by varying the Compute Tier 1 discount rate—to determine which factors most affect your costs. Use these insights to negotiate improved pricing or adjust internal processes.
            </li>
          </ol>
          <p>
            <strong>Outcome:</strong> By following these steps, you gain a clear understanding of your cost drivers. This enables you to renegotiate volume discounts, optimize resource allocation, and revise your budget forecasts—turning potential cost crises into strategic opportunities.
          </p>
        </div>
      </div>
    </div>
    
    <!-- Variable Explanations Section (Not exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#variableSection" aria-expanded="true" aria-controls="variableSection">
        Variable Explanations
      </div>
      <div id="variableSection" class="collapse show">
        <div class="card-body">
          <ul>
            <li><strong>Overall Fixed Cost ($):</strong> Baseline constant expenses.</li>
            <li><strong>Base Revenue per Unit ($):</strong> Revenue per unit at standard rates.</li>
            <li><strong>Revenue Units:</strong> Total units consumed.</li>
            <li><strong>Elasticity Threshold:</strong> Usage level where revenue per unit declines.</li>
            <li><strong>Elasticity Factor:</strong> Decrease in revenue per additional unit beyond threshold.</li>
            <li><strong>Cost Categories:</strong> Fixed and variable costs for compute, storage, network, and licensing with tiered discounts.</li>
            <li><strong>Monthly Growth Rate:</strong> Expected increase in usage and costs month‑over‑month.</li>
            <li><strong>Simulation Iterations:</strong> Number of runs in a Monte Carlo simulation.</li>
            <li><strong>Cost &amp; Revenue Variability:</strong> Expected fluctuations due to market conditions.</li>
          </ul>
        </div>
      </div>
    </div>
    
    <!-- Overall & Revenue Inputs Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#inputsSection" aria-expanded="true" aria-controls="inputsSection">
        Overall &amp; Revenue Inputs
      </div>
      <div id="inputsSection" class="collapse show">
        <div class="card-body">
          <p class="instruction">Enter your overall fixed costs and revenue assumptions.</p>
          <div class="form-group">
            <label for="overallFixedCost">Overall Fixed Cost ($):</label>
            <input type="number" id="overallFixedCost" class="form-control" value="1000" step="any">
          </div>
          <h5>Revenue Inputs</h5>
          <p class="instruction">Provide your base revenue per unit and total revenue units.</p>
          <div class="form-group">
            <label for="revenuePerUnit">Base Revenue per Unit ($):</label>
            <input type="number" id="revenuePerUnit" class="form-control" value="25" step="any">
          </div>
          <div class="form-group">
            <label for="revenueUnits">Revenue Units:</label>
            <input type="number" id="revenueUnits" class="form-control" value="1000" step="any">
          </div>
          <div class="form-group">
            <label for="elasticityThresholdRev">Elasticity Threshold (Units):</label>
            <input type="number" id="elasticityThresholdRev" class="form-control" value="800" step="any">
          </div>
          <div class="form-group">
            <label for="elasticityFactorRev">Elasticity Factor (Revenue $ drop per unit):</label>
            <input type="number" id="elasticityFactorRev" class="form-control" value="0.03" step="any">
          </div>
        </div>
      </div>
    </div>
    
    <!-- Cost Categories Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#costCategoriesSection" aria-expanded="true" aria-controls="costCategoriesSection">
        Cost Categories
      </div>
      <div id="costCategoriesSection" class="collapse show">
        <div class="card-body">
          <p class="instruction">Enter costs for each category.</p>
          <!-- Compute Category -->
          <div class="card mb-3">
            <div class="card-header" data-toggle="collapse" data-target="#computeSection" aria-expanded="true" aria-controls="computeSection">
              Compute
            </div>
            <div id="computeSection" class="collapse show">
              <div class="card-body">
                <p class="instruction">Enter compute costs (e.g., server hours) with tiered discounting.</p>
                <div class="form-row">
                  <div class="form-group col-md-4">
                    <label for="computeFixed">Fixed Cost ($):</label>
                    <input type="number" id="computeFixed" class="form-control" value="500" step="any">
                  </div>
                  <div class="form-group col-md-4">
                    <label for="computeVariable">Variable Cost per Unit ($):</label>
                    <input type="number" id="computeVariable" class="form-control" value="0.15" step="any">
                  </div>
                  <div class="form-group col-md-4">
                    <label for="computeUnits">Units:</label>
                    <input type="number" id="computeUnits" class="form-control" value="6000" step="any">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="computeTier1Threshold">Tier 1 Threshold:</label>
                    <input type="number" id="computeTier1Threshold" class="form-control" value="4000" step="any">
                  </div>
                  <div class="form-group col-md-6">
                    <label for="computeTier1Rate">Tier 1 Discount Rate (%):</label>
                    <input type="number" id="computeTier1Rate" class="form-control" value="5" step="any">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="computeTier2Threshold">Tier 2 Threshold:</label>
                    <input type="number" id="computeTier2Threshold" class="form-control" value="8000" step="any">
                  </div>
                  <div class="form-group col-md-6">
                    <label for="computeTier2Rate">Tier 2 Discount Rate (%):</label>
                    <input type="number" id="computeTier2Rate" class="form-control" value="10" step="any">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Storage Category -->
          <div class="card mb-3">
            <div class="card-header" data-toggle="collapse" data-target="#storageSection" aria-expanded="true" aria-controls="storageSection">
              Storage
            </div>
            <div id="storageSection" class="collapse show">
              <div class="card-body">
                <p class="instruction">Enter storage costs (e.g., GB used) with tiered discounting.</p>
                <div class="form-row">
                  <div class="form-group col-md-4">
                    <label for="storageFixed">Fixed Cost ($):</label>
                    <input type="number" id="storageFixed" class="form-control" value="300" step="any">
                  </div>
                  <div class="form-group col-md-4">
                    <label for="storageVariable">Variable Cost per Unit ($):</label>
                    <input type="number" id="storageVariable" class="form-control" value="0.05" step="any">
                  </div>
                  <div class="form-group col-md-4">
                    <label for="storageUnits">Units (GB):</label>
                    <input type="number" id="storageUnits" class="form-control" value="20000" step="any">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="storageTier1Threshold">Tier 1 Threshold:</label>
                    <input type="number" id="storageTier1Threshold" class="form-control" value="15000" step="any">
                  </div>
                  <div class="form-group col-md-6">
                    <label for="storageTier1Rate">Tier 1 Discount Rate (%):</label>
                    <input type="number" id="storageTier1Rate" class="form-control" value="3" step="any">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="storageTier2Threshold">Tier 2 Threshold:</label>
                    <input type="number" id="storageTier2Threshold" class="form-control" value="30000" step="any">
                  </div>
                  <div class="form-group col-md-6">
                    <label for="storageTier2Rate">Tier 2 Discount Rate (%):</label>
                    <input type="number" id="storageTier2Rate" class="form-control" value="7" step="any">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Network Category -->
          <div class="card mb-3">
            <div class="card-header" data-toggle="collapse" data-target="#networkSection" aria-expanded="true" aria-controls="networkSection">
              Network
            </div>
            <div id="networkSection" class="collapse show">
              <div class="card-body">
                <p class="instruction">Enter network costs (e.g., GB transferred) with tiered discounting.</p>
                <div class="form-row">
                  <div class="form-group col-md-4">
                    <label for="networkFixed">Fixed Cost ($):</label>
                    <input type="number" id="networkFixed" class="form-control" value="200" step="any">
                  </div>
                  <div class="form-group col-md-4">
                    <label for="networkVariable">Variable Cost per Unit ($):</label>
                    <input type="number" id="networkVariable" class="form-control" value="0.10" step="any">
                  </div>
                  <div class="form-group col-md-4">
                    <label for="networkUnits">Units (GB):</label>
                    <input type="number" id="networkUnits" class="form-control" value="10000" step="any">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="networkTier1Threshold">Tier 1 Threshold:</label>
                    <input type="number" id="networkTier1Threshold" class="form-control" value="8000" step="any">
                  </div>
                  <div class="form-group col-md-6">
                    <label for="networkTier1Rate">Tier 1 Discount Rate (%):</label>
                    <input type="number" id="networkTier1Rate" class="form-control" value="4" step="any">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="networkTier2Threshold">Tier 2 Threshold:</label>
                    <input type="number" id="networkTier2Threshold" class="form-control" value="15000" step="any">
                  </div>
                  <div class="form-group col-md-6">
                    <label for="networkTier2Rate">Tier 2 Discount Rate (%):</label>
                    <input type="number" id="networkTier2Rate" class="form-control" value="8" step="any">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- License Category -->
          <div class="card mb-3">
            <div class="card-header" data-toggle="collapse" data-target="#licenseSection" aria-expanded="true" aria-controls="licenseSection">
              License
            </div>
            <div id="licenseSection" class="collapse show">
              <div class="card-body">
                <p class="instruction">Enter licensing costs (e.g., software seats) with volume discounts if applicable.</p>
                <div class="form-row">
                  <div class="form-group col-md-4">
                    <label for="licenseFixed">Fixed Cost ($):</label>
                    <input type="number" id="licenseFixed" class="form-control" value="400" step="any">
                  </div>
                  <div class="form-group col-md-4">
                    <label for="licenseVariable">Variable Cost per Unit ($):</label>
                    <input type="number" id="licenseVariable" class="form-control" value="1.00" step="any">
                  </div>
                  <div class="form-group col-md-4">
                    <label for="licenseUnits">Units:</label>
                    <input type="number" id="licenseUnits" class="form-control" value="300" step="any">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="licenseTier1Threshold">Tier 1 Threshold:</label>
                    <input type="number" id="licenseTier1Threshold" class="form-control" value="250" step="any">
                  </div>
                  <div class="form-group col-md-6">
                    <label for="licenseTier1Rate">Tier 1 Discount Rate (%):</label>
                    <input type="number" id="licenseTier1Rate" class="form-control" value="10" step="any">
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group col-md-6">
                    <label for="licenseTier2Threshold">Tier 2 Threshold:</label>
                    <input type="number" id="licenseTier2Threshold" class="form-control" value="500" step="any">
                  </div>
                  <div class="form-group col-md-6">
                    <label for="licenseTier2Rate">Tier 2 Discount Rate (%):</label>
                    <input type="number" id="licenseTier2Rate" class="form-control" value="15" step="any">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Advanced Settings Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#advancedSection" aria-expanded="true" aria-controls="advancedSection">
        Advanced Settings
      </div>
      <div id="advancedSection" class="collapse show">
        <div class="card-body">
          <p class="instruction">Adjust advanced parameters to optimize your cost model.</p>
          <div class="form-group">
            <label for="autoScalingFactor">Auto-Scaling Factor (%) [reduces compute cost]:</label>
            <input type="number" id="autoScalingFactor" class="form-control" value="0" step="any">
          </div>
          <div class="form-group">
            <label for="dynamicPricingAdjustment">Dynamic Pricing Adjustment (%) [boosts revenue per unit]:</label>
            <input type="number" id="dynamicPricingAdjustment" class="form-control" value="0" step="any">
          </div>
        </div>
      </div>
    </div>
    
    <!-- Cloud Pricing Integration Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#cloudPricingSection" aria-expanded="true" aria-controls="cloudPricingSection">
        Cloud Pricing Integration (Live)
      </div>
      <div id="cloudPricingSection" class="collapse show">
        <div class="card-body">
          <p class="instruction">
            Live pricing integration is not available at this time. Please refer to the Official Pricing Resources.
          </p>
        </div>
      </div>
    </div>
    
    <!-- Forecasting Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#forecastSection" aria-expanded="true" aria-controls="forecastSection">
        Forecasting (12‑Month Projection)
      </div>
      <div id="forecastSection" class="collapse show">
        <div class="card-body">
          <p class="instruction">Enter your expected monthly growth rate to project revenue, costs, and profit.</p>
          <div class="form-group">
            <label for="monthlyGrowth">Monthly Growth Rate (%):</label>
            <input type="number" id="monthlyGrowth" class="form-control" value="5" step="any">
          </div>
          <button id="runForecast" class="btn btn-success mb-3">Run Forecast</button>
          <canvas id="forecastChart" width="600" height="300" style="display:none;"></canvas>
        </div>
      </div>
    </div>
    
    <!-- Deterministic Calculation Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#deterministicSection" aria-expanded="true" aria-controls="deterministicSection">
        Deterministic Calculation &amp; Results
      </div>
      <div id="deterministicSection" class="collapse show">
        <div class="card-body">
          <p class="instruction">Click to calculate key financial metrics and view a cost breakdown.</p>
          <button id="calculateBtn" class="btn btn-warning mb-3">Calculate Deterministic Metrics</button>
          <div id="deterministicResults" class="result export-margin" style="display:none;"></div>
          <canvas id="pieChart" width="400" height="200" style="display:none;"></canvas>
        </div>
      </div>
    </div>
    
    <!-- Monte Carlo Simulation Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#simulationSection" aria-expanded="true" aria-controls="simulationSection">
        Monte Carlo Simulation
      </div>
      <div id="simulationSection" class="collapse show">
        <div class="card-body">
          <p class="instruction">Run a Monte Carlo simulation to assess uncertainty in your estimates.</p>
          <div class="form-row">
            <div class="form-group col-md-4">
              <label for="simIterations">Simulation Iterations:</label>
              <input type="number" id="simIterations" class="form-control" value="1000" step="1">
            </div>
            <div class="form-group col-md-4">
              <label for="costVariability">Cost Variability (%):</label>
              <input type="number" id="costVariability" class="form-control" value="10" step="any">
            </div>
            <div class="form-group col-md-4">
              <label for="revenueVariability">Revenue Variability (%):</label>
              <input type="number" id="revenueVariability" class="form-control" value="10" step="any">
            </div>
          </div>
          <button id="runSimulation" class="btn btn-danger mb-3">Run Simulation</button>
          <div id="simulationResults" class="result export-margin" style="display:none;"></div>
          <canvas id="histogramChart" width="600" height="300" style="display:none;"></canvas>
        </div>
      </div>
    </div>
    
    <!-- Sensitivity Analysis Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#sensitivitySection" aria-expanded="true" aria-controls="sensitivitySection">
        Sensitivity Analysis
      </div>
      <div id="sensitivitySection" class="collapse show">
        <div class="card-body">
          <p class="instruction">Vary the Compute Tier 1 discount rate and observe its effect on profit.</p>
          <button id="runSensitivity" class="btn btn-info mb-3">Run Sensitivity Analysis</button>
          <div id="sensitivityResults" class="result export-margin" style="display:none;"></div>
        </div>
      </div>
    </div>
    
    <!-- Notes Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#notesSection" aria-expanded="true" aria-controls="notesSection">
        Notes
      </div>
      <div id="notesSection" class="collapse show">
        <div class="card-body">
          <p class="instruction">Enter any notes here. These will be saved locally and included in the exported report.</p>
          <div class="form-group">
            <textarea id="userNotes" class="form-control" rows="4" placeholder="Enter your notes here..."></textarea>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Export Report Section (Exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#exportSection" aria-expanded="true" aria-controls="exportSection">
        Export Report
      </div>
      <div id="exportSection" class="collapse show">
        <div class="card-body">
          <p class="instruction">Generate a PDF report including Deterministic Results, Forecast Chart, Monte Carlo Simulation Summary, Sensitivity Analysis, and User Notes. The report will display the current date.</p>
          <button id="exportReportBtn" class="btn btn-secondary">Export Report as PDF</button>
        </div>
      </div>
    </div>
    
    <!-- Official Pricing Resources Section (Not exported) -->
    <div class="card section-card">
      <div class="card-header" data-toggle="collapse" data-target="#pricingResourcesSection" aria-expanded="true" aria-controls="pricingResourcesSection">
        Official Pricing Resources
      </div>
      <div id="pricingResourcesSection" class="collapse show">
        <div class="card-body">
          <p>For the most accurate pricing, please refer to:</p>
          <ul>
            <li><a href="https://aws.amazon.com/pricing/" target="_blank">AWS Pricing</a></li>
            <li><a href="https://azure.microsoft.com/en-us/pricing/" target="_blank">Azure Pricing</a></li>
            <li><a href="https://cloud.google.com/pricing" target="_blank">Google Cloud Pricing</a></li>
          </ul>
        </div>
      </div>
    </div>
    
    <!-- Footer -->
    <footer>
      <p style="color: orange;">
        (c)(p) 2025 Tully EDM Vibe LLC All Rights Reserved.
        <br>
        WARNING: These calculations are estimates. Users should conduct further analysis and vet these results. All risk is the user's responsibility as this tool is educational in nature.
      </p>
    </footer>
  </div>
  
  <!-- Dependencies: jQuery, Bootstrap JS, Chart.js, jsPDF -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    // Persist inputs and textareas using localStorage
    function persistInputs() {
      const elements = document.querySelectorAll('input[type="number"], textarea');
      elements.forEach(el => {
        const stored = localStorage.getItem(el.id);
        if (stored !== null) {
          el.value = stored;
        }
        el.addEventListener('change', () => { 
          localStorage.setItem(el.id, el.value); 
        });
      });
    }
    window.addEventListener('DOMContentLoaded', persistInputs);
    
    // Helper: Compute Category Cost
    function computeCategoryCost(units, baseCost, tier1Threshold, tier1Rate, tier2Threshold, tier2Rate) {
      if (units <= tier1Threshold) {
        return units * baseCost;
      } else if (units <= tier2Threshold) {
        return tier1Threshold * baseCost + (units - tier1Threshold) * baseCost * (1 - tier1Rate / 100);
      } else {
        return tier1Threshold * baseCost +
               (tier2Threshold - tier1Threshold) * baseCost * (1 - tier1Rate / 100) +
               (units - tier2Threshold) * baseCost * (1 - tier2Rate / 100);
      }
    }
    
    // Deterministic Calculation
    document.getElementById('calculateBtn').addEventListener('click', () => {
      const overallFixedCost = parseFloat(document.getElementById('overallFixedCost').value);
      const revenuePerUnit = parseFloat(document.getElementById('revenuePerUnit').value);
      const revenueUnits = parseFloat(document.getElementById('revenueUnits').value);
      const elasticityThresholdRev = parseFloat(document.getElementById('elasticityThresholdRev').value);
      const elasticityFactorRev = parseFloat(document.getElementById('elasticityFactorRev').value);
      const dynamicPricingAdjustment = parseFloat(document.getElementById('dynamicPricingAdjustment').value);
      const autoScalingFactor = parseFloat(document.getElementById('autoScalingFactor').value);
      
      let effectiveRevenuePerUnit = revenuePerUnit;
      if (revenueUnits > elasticityThresholdRev) {
        effectiveRevenuePerUnit = Math.max(revenuePerUnit - elasticityFactorRev * (revenueUnits - elasticityThresholdRev), 0);
      }
      effectiveRevenuePerUnit *= (1 + dynamicPricingAdjustment / 100);
      const totalRevenue = revenueUnits * effectiveRevenuePerUnit;
      
      const computeFixed = parseFloat(document.getElementById('computeFixed').value);
      const computeVariable = parseFloat(document.getElementById('computeVariable').value);
      const computeUnits = parseFloat(document.getElementById('computeUnits').value);
      const computeTier1Threshold = parseFloat(document.getElementById('computeTier1Threshold').value);
      const computeTier1Rate = parseFloat(document.getElementById('computeTier1Rate').value);
      const computeTier2Threshold = parseFloat(document.getElementById('computeTier2Threshold').value);
      const computeTier2Rate = parseFloat(document.getElementById('computeTier2Rate').value);
      let computeCost = computeFixed + computeCategoryCost(computeUnits, computeVariable, computeTier1Threshold, computeTier1Rate, computeTier2Threshold, computeTier2Rate);
      computeCost *= (1 - autoScalingFactor / 100);
      
      const storageFixed = parseFloat(document.getElementById('storageFixed').value);
      const storageVariable = parseFloat(document.getElementById('storageVariable').value);
      const storageUnits = parseFloat(document.getElementById('storageUnits').value);
      const storageTier1Threshold = parseFloat(document.getElementById('storageTier1Threshold').value);
      const storageTier1Rate = parseFloat(document.getElementById('storageTier1Rate').value);
      const storageTier2Threshold = parseFloat(document.getElementById('storageTier2Threshold').value);
      const storageTier2Rate = parseFloat(document.getElementById('storageTier2Rate').value);
      const storageCost = storageFixed + computeCategoryCost(storageUnits, storageVariable, storageTier1Threshold, storageTier1Rate, storageTier2Threshold, storageTier2Rate);
      
      const networkFixed = parseFloat(document.getElementById('networkFixed').value);
      const networkVariable = parseFloat(document.getElementById('networkVariable').value);
      const networkUnits = parseFloat(document.getElementById('networkUnits').value);
      const networkTier1Threshold = parseFloat(document.getElementById('networkTier1Threshold').value);
      const networkTier1Rate = parseFloat(document.getElementById('networkTier1Rate').value);
      const networkTier2Threshold = parseFloat(document.getElementById('networkTier2Threshold').value);
      const networkTier2Rate = parseFloat(document.getElementById('networkTier2Rate').value);
      const networkCost = networkFixed + computeCategoryCost(networkUnits, networkVariable, networkTier1Threshold, networkTier1Rate, networkTier2Threshold, networkTier2Rate);
      
      const licenseFixed = parseFloat(document.getElementById('licenseFixed').value);
      const licenseVariable = parseFloat(document.getElementById('licenseVariable').value);
      const licenseUnits = parseFloat(document.getElementById('licenseUnits').value);
      const licenseTier1Threshold = parseFloat(document.getElementById('licenseTier1Threshold').value);
      const licenseTier1Rate = parseFloat(document.getElementById('licenseTier1Rate').value);
      const licenseTier2Threshold = parseFloat(document.getElementById('licenseTier2Threshold').value);
      const licenseTier2Rate = parseFloat(document.getElementById('licenseTier2Rate').value);
      const licenseCost = licenseFixed + computeCategoryCost(licenseUnits, licenseVariable, licenseTier1Threshold, licenseTier1Rate, licenseTier2Threshold, licenseTier2Rate);
      
      const totalCost = overallFixedCost + computeCost + storageCost + networkCost + licenseCost;
      const profit = totalRevenue - totalCost;
      const profitMargin = totalRevenue ? (profit / totalRevenue * 100).toFixed(2) : "N/A";
      const roi = totalCost ? (profit / totalCost * 100).toFixed(2) : "N/A";
      
      const resultsDiv = document.getElementById('deterministicResults');
      resultsDiv.style.display = 'block';
      const detText = `Deterministic Results:
Total Revenue: $${totalRevenue.toFixed(2)}
Total Cost: $${totalCost.toFixed(2)}
Profit: $${profit.toFixed(2)}
Profit Margin: ${profitMargin}%
ROI: ${roi}%
Cost Breakdown:
  Compute: $${computeCost.toFixed(2)}
  Storage: $${storageCost.toFixed(2)}
  Network: $${networkCost.toFixed(2)}
  License: $${licenseCost.toFixed(2)}`;
      resultsDiv.innerHTML = `<pre>${detText}</pre>`;
      
      const pieCtx = document.getElementById('pieChart').getContext('2d');
      document.getElementById('pieChart').style.display = 'block';
      if (window.myPieChart) window.myPieChart.destroy();
      window.myPieChart = new Chart(pieCtx, {
        type: 'pie',
        data: {
          labels: ['Compute', 'Storage', 'Network', 'License'],
          datasets: [{
            data: [computeCost, storageCost, networkCost, licenseCost],
            backgroundColor: ['rgba(255, 99, 132, 0.6)', 'rgba(54, 162, 235, 0.6)', 'rgba(255, 206, 86, 0.6)', 'rgba(75, 192, 192, 0.6)']
          }]
        },
        options: { plugins: { legend: { position: 'bottom' } } }
      });
    });
    
    // Forecasting (12‑Month Projection)
    document.getElementById('runForecast').addEventListener('click', () => {
      const months = 12;
      const monthlyGrowth = parseFloat(document.getElementById('monthlyGrowth').value) / 100;
      const overallFixedCost = parseFloat(document.getElementById('overallFixedCost').value);
      const revenuePerUnit = parseFloat(document.getElementById('revenuePerUnit').value);
      const revenueUnits = parseFloat(document.getElementById('revenueUnits').value);
      const elasticityThresholdRev = parseFloat(document.getElementById('elasticityThresholdRev').value);
      const elasticityFactorRev = parseFloat(document.getElementById('elasticityFactorRev').value);
      const dynamicPricingAdjustment = parseFloat(document.getElementById('dynamicPricingAdjustment').value);
      
      function getBaselineCost(idPrefix) {
        const fixed = parseFloat(document.getElementById(idPrefix + 'Fixed').value);
        const variable = parseFloat(document.getElementById(idPrefix + 'Variable').value);
        const units = parseFloat(document.getElementById(idPrefix + 'Units').value);
        const tier1Threshold = parseFloat(document.getElementById(idPrefix + 'Tier1Threshold').value);
        const tier1Rate = parseFloat(document.getElementById(idPrefix + 'Tier1Rate').value);
        const tier2Threshold = parseFloat(document.getElementById(idPrefix + 'Tier2Threshold').value);
        const tier2Rate = parseFloat(document.getElementById(idPrefix + 'Tier2Rate').value);
        return fixed + computeCategoryCost(units, variable, tier1Threshold, tier1Rate, tier2Threshold, tier2Rate);
      }
      const computeCostBase = getBaselineCost('compute');
      const storageCostBase = getBaselineCost('storage');
      const networkCostBase = getBaselineCost('network');
      const licenseCostBase = getBaselineCost('license');
      const overallCostBase = overallFixedCost + computeCostBase + storageCostBase + networkCostBase + licenseCostBase;
      
      let forecastMonths = [];
      let forecastRevenue = [];
      let forecastCost = [];
      let forecastProfit = [];
      
      let currentRevenueUnits = revenueUnits;
      let currentOverallCost = overallCostBase;
      for (let m = 0; m <= months; m++) {
        let effectiveRevenuePerUnit = revenuePerUnit;
        if (currentRevenueUnits > elasticityThresholdRev) {
          effectiveRevenuePerUnit = Math.max(revenuePerUnit - elasticityFactorRev * (currentRevenueUnits - elasticityThresholdRev), 0);
        }
        effectiveRevenuePerUnit *= (1 + dynamicPricingAdjustment / 100);
        const totalRev = currentRevenueUnits * effectiveRevenuePerUnit;
        forecastMonths.push("Month " + m);
        forecastRevenue.push(totalRev);
        forecastCost.push(currentOverallCost);
        forecastProfit.push(totalRev - currentOverallCost);
        
        currentRevenueUnits *= (1 + monthlyGrowth);
        currentOverallCost *= (1 + monthlyGrowth);
      }
      
      const forecastCtx = document.getElementById('forecastChart').getContext('2d');
      document.getElementById('forecastChart').style.display = 'block';
      if (window.myForecastChart) window.myForecastChart.destroy();
      window.myForecastChart = new Chart(forecastCtx, {
        type: 'line',
        data: {
          labels: forecastMonths,
          datasets: [
            { label: 'Revenue', data: forecastRevenue, borderColor: 'rgba(75, 192, 192, 1)', fill: false },
            { label: 'Cost', data: forecastCost, borderColor: 'rgba(255, 99, 132, 1)', fill: false },
            { label: 'Profit', data: forecastProfit, borderColor: 'rgba(54, 162, 235, 1)', fill: false }
          ]
        },
        options: {
          plugins: { legend: { position: 'bottom' } },
          scales: { y: { beginAtZero: true } }
        }
      });
    });
    
    // Monte Carlo Simulation
    document.getElementById('runSimulation').addEventListener('click', () => {
      const simIterations = parseInt(document.getElementById('simIterations').value);
      const costVariability = parseFloat(document.getElementById('costVariability').value) / 100;
      const revenueVariability = parseFloat(document.getElementById('revenueVariability').value) / 100;
      const revenuePerUnit = parseFloat(document.getElementById('revenuePerUnit').value);
      const revenueUnits = parseFloat(document.getElementById('revenueUnits').value);
      const elasticityThresholdRev = parseFloat(document.getElementById('elasticityThresholdRev').value);
      const elasticityFactorRev = parseFloat(document.getElementById('elasticityFactorRev').value);
      const overallFixedCost = parseFloat(document.getElementById('overallFixedCost').value);
      const dynamicPricingAdjustment = parseFloat(document.getElementById('dynamicPricingAdjustment').value);
      
      function getCategoryInputs(idPrefix) {
        return {
          fixed: parseFloat(document.getElementById(idPrefix + 'Fixed').value),
          variable: parseFloat(document.getElementById(idPrefix + 'Variable').value),
          units: parseFloat(document.getElementById(idPrefix + 'Units').value),
          tier1Threshold: parseFloat(document.getElementById(idPrefix + 'Tier1Threshold').value),
          tier1Rate: parseFloat(document.getElementById(idPrefix + 'Tier1Rate').value),
          tier2Threshold: parseFloat(document.getElementById(idPrefix + 'Tier2Threshold').value),
          tier2Rate: parseFloat(document.getElementById(idPrefix + 'Tier2Rate').value)
        };
      }
      const computeInputs = getCategoryInputs('compute');
      const storageInputs = getCategoryInputs('storage');
      const networkInputs = getCategoryInputs('network');
      const licenseInputs = getCategoryInputs('license');
      
      function getRandomNormal() {
        let u = 0, v = 0;
        while(u === 0) u = Math.random();
        while(v === 0) v = Math.random();
        return Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
      }
      
      const simulationProfits = [];
      for (let i = 0; i < simIterations; i++) {
        const costMultiplier = 1 + getRandomNormal() * costVariability;
        const revenueMultiplier = 1 + getRandomNormal() * revenueVariability;
        
        const simComputeCost = computeInputs.fixed + computeCategoryCost(
          computeInputs.units,
          computeInputs.variable * costMultiplier,
          computeInputs.tier1Threshold,
          computeInputs.tier1Rate,
          computeInputs.tier2Threshold,
          computeInputs.tier2Rate
        );
        const simStorageCost = storageInputs.fixed + computeCategoryCost(
          storageInputs.units,
          storageInputs.variable * costMultiplier,
          storageInputs.tier1Threshold,
          storageInputs.tier1Rate,
          storageInputs.tier2Threshold,
          storageInputs.tier2Rate
        );
        const simNetworkCost = networkInputs.fixed + computeCategoryCost(
          networkInputs.units,
          networkInputs.variable * costMultiplier,
          networkInputs.tier1Threshold,
          networkInputs.tier1Rate,
          networkInputs.tier2Threshold,
          networkInputs.tier2Rate
        );
        const simLicenseCost = licenseInputs.fixed + computeCategoryCost(
          licenseInputs.units,
          licenseInputs.variable * costMultiplier,
          licenseInputs.tier1Threshold,
          licenseInputs.tier1Rate,
          licenseInputs.tier2Threshold,
          licenseInputs.tier2Rate
        );
        const totalSimCost = overallFixedCost + simComputeCost + simStorageCost + simNetworkCost + simLicenseCost;
        
        let simEffectiveRevenue = revenuePerUnit * revenueMultiplier;
        if (revenueUnits > elasticityThresholdRev) {
          simEffectiveRevenue = Math.max(revenuePerUnit * revenueMultiplier - elasticityFactorRev * (revenueUnits - elasticityThresholdRev), 0);
        }
        simEffectiveRevenue *= (1 + dynamicPricingAdjustment / 100);
        const totalSimRevenue = revenueUnits * simEffectiveRevenue;
        simulationProfits.push(totalSimRevenue - totalSimCost);
      }
      
      const sumProfit = simulationProfits.reduce((a, b) => a + b, 0);
      const avgProfit = sumProfit / simulationProfits.length;
      const minProfit = Math.min(...simulationProfits);
      const maxProfit = Math.max(...simulationProfits);
      const stdProfit = Math.sqrt(simulationProfits.reduce((a, b) => a + Math.pow(b - avgProfit, 2), 0) / simulationProfits.length);
      
      const numBins = 10;
      const profitRange = maxProfit - minProfit;
      const binSize = profitRange / numBins;
      const bins = new Array(numBins).fill(0);
      const binLabels = [];
      simulationProfits.forEach(profit => {
        let binIndex = Math.floor((profit - minProfit) / binSize);
        if (binIndex === numBins) binIndex = numBins - 1;
        bins[binIndex]++;
      });
      for (let i = 0; i < numBins; i++) {
        const binCenter = minProfit + binSize * (i + 0.5);
        binLabels.push(binCenter.toFixed(2));
      }
      
      const simResultsDiv = document.getElementById('simulationResults');
      simResultsDiv.style.display = 'block';
      const simText = `Monte Carlo Simulation (over ${simIterations} iterations):
Average Profit: $${avgProfit.toFixed(2)}
Minimum Profit: $${minProfit.toFixed(2)}
Maximum Profit: $${maxProfit.toFixed(2)}
Standard Deviation: $${stdProfit.toFixed(2)}`;
      simResultsDiv.innerHTML = `<pre>${simText}</pre>`;
      
      const histCtx = document.getElementById('histogramChart').getContext('2d');
      document.getElementById('histogramChart').style.display = 'block';
      if (window.myHistChart) window.myHistChart.destroy();
      window.myHistChart = new Chart(histCtx, {
        type: 'bar',
        data: {
          labels: binLabels,
          datasets: [{
            label: 'Profit Frequency',
            data: bins,
            backgroundColor: 'rgba(75, 192, 192, 0.6)'
          }]
        },
        options: { plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
      });
    });
    
    // Sensitivity Analysis
    document.getElementById('runSensitivity').addEventListener('click', () => {
      const baseRate = parseFloat(document.getElementById('computeTier1Rate').value);
      const sensitivityData = [];
      const sensitivityLabels = [];
      // Vary Compute Tier 1 discount rate from (baseRate - 5) to (baseRate + 5)
      for (let delta = -5; delta <= 5; delta += 1) {
        const testRate = baseRate + delta;
        const computeFixed = parseFloat(document.getElementById('computeFixed').value);
        const computeVariable = parseFloat(document.getElementById('computeVariable').value);
        const computeUnits = parseFloat(document.getElementById('computeUnits').value);
        const computeTier1Threshold = parseFloat(document.getElementById('computeTier1Threshold').value);
        const computeTier2Threshold = parseFloat(document.getElementById('computeTier2Threshold').value);
        const computeTier2Rate = parseFloat(document.getElementById('computeTier2Rate').value);
        const modifiedComputeCost = computeFixed + computeCategoryCost(computeUnits, computeVariable, computeTier1Threshold, testRate, computeTier2Threshold, computeTier2Rate);
        
        const overallFixedCost = parseFloat(document.getElementById('overallFixedCost').value);
        const revenuePerUnit = parseFloat(document.getElementById('revenuePerUnit').value);
        const revenueUnits = parseFloat(document.getElementById('revenueUnits').value);
        const elasticityThresholdRev = parseFloat(document.getElementById('elasticityThresholdRev').value);
        const elasticityFactorRev = parseFloat(document.getElementById('elasticityFactorRev').value);
        let effectiveRevenuePerUnit = revenuePerUnit;
        if (revenueUnits > elasticityThresholdRev) {
          effectiveRevenuePerUnit = Math.max(revenuePerUnit - elasticityFactorRev * (revenueUnits - elasticityThresholdRev), 0);
        }
        const totalRevenue = revenueUnits * effectiveRevenuePerUnit;
        
        const storageCost = parseFloat(document.getElementById('storageFixed').value) +
          computeCategoryCost(
            parseFloat(document.getElementById('storageUnits').value),
            parseFloat(document.getElementById('storageVariable').value),
            parseFloat(document.getElementById('storageTier1Threshold').value),
            parseFloat(document.getElementById('storageTier1Rate').value),
            parseFloat(document.getElementById('storageTier2Threshold').value),
            parseFloat(document.getElementById('storageTier2Rate').value)
          );
        const networkCost = parseFloat(document.getElementById('networkFixed').value) +
          computeCategoryCost(
            parseFloat(document.getElementById('networkUnits').value),
            parseFloat(document.getElementById('networkVariable').value),
            parseFloat(document.getElementById('networkTier1Threshold').value),
            parseFloat(document.getElementById('networkTier1Rate').value),
            parseFloat(document.getElementById('networkTier2Threshold').value),
            parseFloat(document.getElementById('networkTier2Rate').value)
          );
        const licenseCost = parseFloat(document.getElementById('licenseFixed').value) +
          computeCategoryCost(
            parseFloat(document.getElementById('licenseUnits').value),
            parseFloat(document.getElementById('licenseVariable').value),
            parseFloat(document.getElementById('licenseTier1Threshold').value),
            parseFloat(document.getElementById('licenseTier1Rate').value),
            parseFloat(document.getElementById('licenseTier2Threshold').value),
            parseFloat(document.getElementById('licenseTier2Rate').value)
          );
        const totalCost = overallFixedCost + modifiedComputeCost + storageCost + networkCost + licenseCost;
        const profit = totalRevenue - totalCost;
        sensitivityData.push(profit);
        sensitivityLabels.push(testRate.toFixed(2) + "%");
      }
      
      const sensitivityResultsDiv = document.getElementById('sensitivityResults');
      sensitivityResultsDiv.style.display = 'block';
      let sensitivityText = "Sensitivity Analysis: Profit vs. Compute Tier 1 Discount Rate\n";
      sensitivityLabels.forEach((label, i) => {
        sensitivityText += `${label}: $${sensitivityData[i].toFixed(2)}\n`;
      });
      sensitivityResultsDiv.innerHTML = `<pre>${sensitivityText}</pre>`;
    });
    
    // Export Report as PDF
    async function exportReport() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      // Set text color to black
      doc.setTextColor(0, 0, 0);
      let yPos = 15;
      
      // Add current date at top
      const currentDate = new Date().toISOString().split("T")[0];
      doc.setFontSize(10);
      doc.text("Date: " + currentDate, 10, yPos);
      yPos += 8;
      
      // Title
      doc.setFontSize(16);
      doc.text("FinOps++ Analysis Report", 10, yPos);
      yPos += 10;
      
      // Deterministic Results
      doc.setFontSize(12);
      doc.text("Deterministic Results:", 10, yPos);
      yPos += 6;
      let detText = document.getElementById("deterministicResults").innerText;
      let detLines = doc.splitTextToSize(detText, 180);
      doc.text(detLines, 10, yPos);
      yPos += detLines.length * 6 + 4;
      
      // Forecast Chart (if available)
      const forecastCanvas = document.getElementById('forecastChart');
      if (forecastCanvas && forecastCanvas.style.display !== 'none') {
        const imgData = forecastCanvas.toDataURL("image/png");
        yPos += 10;
        doc.text("12‑Month Forecast Chart:", 10, yPos);
        yPos += 6;
        doc.addImage(imgData, 'PNG', 10, yPos, 180, 80);
        yPos += 80 + 4;
      }
      
      // Monte Carlo Simulation Summary
      doc.text("Monte Carlo Simulation Summary:", 10, yPos);
      yPos += 6;
      let simText = document.getElementById("simulationResults").innerText;
      let simLines = doc.splitTextToSize(simText, 180);
      doc.text(simLines, 10, yPos);
      yPos += simLines.length * 6 + 4;
      
      // Sensitivity Analysis
      doc.text("Sensitivity Analysis:", 10, yPos);
      yPos += 6;
      let sensText = document.getElementById("sensitivityResults").innerText;
      let sensLines = doc.splitTextToSize(sensText, 180);
      doc.text(sensLines, 10, yPos);
      yPos += sensLines.length * 6 + 4;
      
      // User Notes
      doc.text("User Notes:", 10, yPos);
      yPos += 6;
      let notes = document.getElementById("userNotes").value;
      let notesLines = doc.splitTextToSize(notes, 180);
      doc.text(notesLines, 10, yPos);
      yPos += notesLines.length * 6 + 4;
      
      // Save PDF
      doc.save("FinOps_Report.pdf");
    }
    document.getElementById('exportReportBtn').addEventListener('click', exportReport);
  </script>
</body>
</html>
