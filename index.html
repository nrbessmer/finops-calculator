<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FinOps++</title>
  <!-- Bootstrap CSS for modern styling -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- Custom CSS using Tahoma -->
  <style>
    body { 
      background: #121212; 
      font-family: Tahoma, sans-serif;
      color: #e0e0e0;
      padding-bottom: 2rem;
    }
    /* Header styling */
    .header {
      background: #222;
      color: #f5f5f5;
      padding: 3rem 0;
      text-align: center;
      border-bottom: 3px solid #0d6efd;
      margin-bottom: 2rem;
    }
    .header h1 {
      font-size: 3rem;
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .header p {
      font-size: 1.2rem;
      margin: 0;
      color: #ccc;
    }
    /* Section styling */
    .section-card { 
      margin-bottom: 2rem; 
      border: 1px solid #333;
      background: #1e1e1e;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .card-header { 
      background-color: #0d6efd; 
      color: #ffffff; 
      text-transform: uppercase;
      font-weight: bold;
      border-bottom: 1px solid #333;
    }
    .card-body {
      background: #1e1e1e;
    }
    .instruction { 
      font-size: 0.9rem; 
      color: #bbb; 
      margin-bottom: 1rem; 
    }
    .form-control {
      background: #2c2c2c;
      border: 1px solid #555;
      color: #e0e0e0;
    }
    .form-control:focus {
      background: #2c2c2c;
      border-color: #0d6efd;
      box-shadow: none;
      color: #fff;
    }
    .btn {
      border: none;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    footer { 
      text-align: center; 
      padding: 1rem 0; 
      margin-top: 2rem; 
      background: #1e1e1e; 
      color: #aaa;
      border-top: 1px solid #333;
    }
    a { color: #0d6efd; }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <h1>FinOps++</h1>
    <p>Cost Modeling • Live Cloud Pricing • Forecasting • Simulation • Exportable Reports</p>
  </div>

  <div class="container">
    <!-- Extended Overview Section -->
    <div class="card section-card">
      <div class="card-header">Overview</div>
      <div class="card-body">
        <p>
          Cloud computing has revolutionized the way organizations operate—offering unprecedented scalability, agility, and innovation. However, this transformative power comes with a complexity of pricing models, discount tiers, and variable cost structures that can easily lead to unexpected expenses if not managed carefully. FinOps++ was developed to address these challenges head on by providing a comprehensive, interactive platform to model, forecast, and simulate cloud costs in real time.
        </p>
        <p>
          FinOps++ integrates live pricing data directly from major cloud providers (AWS, Azure, and GCP) so that every cost calculation reflects the most up-to-date market conditions. This live data integration ensures that your cost estimates are current, reducing the risk of budget overruns and enabling proactive financial planning.
        </p>
        <p>
          The tool’s robust architecture allows you to break down cloud spending into granular components: compute, storage, network, and licensing. Each of these components can be modeled with tiered discount rates and usage thresholds that mirror real-world pricing structures. By simulating various scenarios, FinOps++ helps you understand how changes in workload, discount rates, or pricing strategies impact your overall spending.
        </p>
        <p>
          With advanced forecasting capabilities, FinOps++ enables you to project cloud costs over a 12‑month period. By inputting your monthly growth rate, you can simulate future spending, identify potential cost overages, and plan strategically for capacity expansion or cost optimization initiatives.
        </p>
        <p>
          Beyond static cost modeling, FinOps++ incorporates Monte Carlo simulations to account for uncertainty and variability in usage and pricing. This feature allows you to run thousands of iterations to generate a probability distribution of possible outcomes, thus quantifying risk and helping you plan for worst-case scenarios.
        </p>
        <p>
          Sensitivity analysis is another critical feature that helps you pinpoint which variables most significantly affect your bottom line. By adjusting discount rates, thresholds, or variability factors, you can see in real time how sensitive your overall cost is to these changes—guiding negotiations and strategic decisions.
        </p>
        <p>
          FinOps++ is not just a calculator—it’s an educational tool that provides detailed explanations for every variable and cost factor, ensuring that both technical and financial stakeholders are aligned. This clarity facilitates more effective communication between IT and finance teams, enabling them to work together to optimize cloud spending.
        </p>
        <p>
          The platform is designed with scalability in mind. Whether you are a startup or a large enterprise, FinOps++ scales with your business needs by offering flexible input parameters and a modular design that adapts to different cloud pricing models.
        </p>
        <p>
          By combining live pricing data, advanced simulation methods, and comprehensive forecasting tools, FinOps++ transforms the challenge of managing cloud expenses into a data-driven, actionable process. It empowers you to take control of your cloud costs, reduce financial risk, and make smarter strategic decisions.
        </p>
        <p>
          Ultimately, FinOps++ is your partner in navigating the complex landscape of cloud financial management. With this tool, you can achieve greater transparency, optimize resource allocation, and ensure that your cloud investments are aligned with your overall business strategy.
        </p>
      </div>
    </div>

    <!-- Detailed Practical Use Cases Section -->
    <div class="card section-card">
      <div class="card-header">Practical Use Cases</div>
      <div class="card-body">
        <p>
          <strong>Hypothetical Business Scenario:</strong> Imagine you are the CFO of "CloudSavvy Retail," a mid-sized e-commerce company that relies on cloud services for hosting its website, managing customer data, and processing transactions. Over the past quarter, a viral marketing campaign unexpectedly increased website traffic by 300%, leading to a surge in compute, storage, and network usage. This surge resulted in cloud cost overages that far exceeded your monthly budget and threatened to erode your profit margins.
        </p>
        <p>
          <strong>Step 1: Data Input and Baseline Setup</strong><br>
          You begin by launching FinOps++ and entering the overall fixed costs associated with your cloud operations. These costs include base server fees, management overhead, and baseline software licensing expenses. Next, you input revenue assumptions—detailing the average revenue per transaction and the expected number of transactions under normal conditions. You also set an elasticity threshold to account for how revenue per transaction decreases when usage exceeds expected limits.
        </p>
        <p>
          <strong>Step 2: Detailed Cost Breakdown</strong><br>
          FinOps++ allows you to break down your cloud spending into specific categories. For compute costs, you enter the fixed base cost and variable cost per compute hour along with tiered discount thresholds that mirror your cloud provider’s pricing model. Similarly, you enter costs for storage (GBs of data stored), network (data transferred), and licensing (software seats). This detailed breakdown helps you understand which area is the primary driver of cost overages.
        </p>
        <p>
          <strong>Step 3: Running Deterministic Calculations</strong><br>
          With all data in place, you run the deterministic calculation feature to obtain key metrics: total revenue, total cost, profit, profit margin, and ROI. This baseline analysis provides you with a snapshot of your current financial state and highlights the immediate impact of the unexpected surge in usage.
        </p>
        <p>
          <strong>Step 4: Forecasting Future Costs</strong><br>
          Anticipating that similar spikes could occur in the future, you use the forecasting module to project cloud costs over the next 12 months. By inputting your estimated monthly growth rate, FinOps++ generates a forecast that shows how costs might escalate if the current trend continues. This forecast helps you plan for additional budget allocation or cost-cutting measures.
        </p>
        <p>
          <strong>Step 5: Monte Carlo Simulation for Risk Assessment</strong><br>
          To address uncertainty, you run a Monte Carlo simulation that uses historical variability in cost and revenue data. This simulation runs thousands of iterations to provide a range of possible financial outcomes, quantifying the probability of further cost overages. Armed with this statistical risk assessment, you can make more informed decisions about setting aside contingency funds or adjusting operational practices.
        </p>
        <p>
          <strong>Step 6: Sensitivity Analysis for Strategic Optimization</strong><br>
          Finally, you perform a sensitivity analysis by varying key discount parameters—particularly those affecting compute costs. This analysis reveals that a modest improvement in discount rates (achievable through renegotiation with your provider) could significantly reduce overall expenses. As a result, you decide to engage with your cloud provider to explore better volume discounts or alternative pricing models.
        </p>
        <p>
          <strong>Outcome:</strong> By following these steps with FinOps++, you not only gain a clear understanding of the factors driving your cloud cost overages but also develop actionable strategies to mitigate future risks. You implement changes to optimize resource allocation, secure more favorable pricing terms, and adjust your budget forecasts, thereby transforming a crisis into an opportunity for strategic improvement.
        </p>
      </div>
    </div>

    <!-- Variable Explanations Section -->
    <div class="card section-card">
      <div class="card-header">Variable Explanations</div>
      <div class="card-body">
        <ul>
          <li><strong>Overall Fixed Cost ($):</strong> The baseline expenses that do not change with usage (e.g., server management fees).</li>
          <li><strong>Base Revenue per Unit ($):</strong> The revenue earned from each unit sold or service rendered at standard rates.</li>
          <li><strong>Revenue Units:</strong> The total number of transactions or service units consumed.</li>
          <li><strong>Elasticity Threshold (Revenue Units):</strong> The usage point beyond which revenue per unit decreases.</li>
          <li><strong>Elasticity Factor:</strong> The decrement in revenue per unit for each additional unit beyond the threshold.</li>
          <li><strong>Fixed Cost (per category):</strong> Constant costs specific to a service area (compute, storage, network, licensing).</li>
          <li><strong>Variable Cost per Unit:</strong> Costs that scale with usage (e.g., per compute hour, per GB stored).</li>
          <li><strong>Tier 1 &amp; Tier 2 Thresholds:</strong> Usage limits that trigger discount pricing.</li>
          <li><strong>Tier 1 &amp; Tier 2 Discount Rates (%):</strong> Percentage discounts applied when usage exceeds designated thresholds.</li>
          <li><strong>Monthly Growth Rate (%):</strong> Expected percentage increase in usage and costs month over month.</li>
          <li><strong>Simulation Iterations:</strong> Number of runs in a Monte Carlo simulation to model variability in cost outcomes.</li>
          <li><strong>Cost &amp; Revenue Variability (%):</strong> The anticipated fluctuation in costs and revenues.</li>
          <li><strong>Live Cloud Pricing:</strong> Real-time pricing data fetched directly from AWS, Azure, and GCP.</li>
        </ul>
      </div>
    </div>

    <!-- Overall & Revenue Inputs Section -->
    <div class="card section-card">
      <div class="card-header">Overall &amp; Revenue Inputs</div>
      <div class="card-body">
        <p class="instruction">
          Enter your overall fixed costs and revenue assumptions that form the basis of your financial model.
        </p>
        <div class="form-group">
          <label for="overallFixedCost">Overall Fixed Cost ($):</label>
          <input type="number" id="overallFixedCost" class="form-control" value="1000" step="any">
        </div>
        <h5>Revenue Inputs</h5>
        <p class="instruction">
          Provide your base revenue per unit and the total number of revenue units. An elasticity factor will adjust your revenue per unit if consumption exceeds the threshold.
        </p>
        <div class="form-group">
          <label for="revenuePerUnit">Base Revenue per Unit ($):</label>
          <input type="number" id="revenuePerUnit" class="form-control" value="25" step="any">
        </div>
        <div class="form-group">
          <label for="revenueUnits">Revenue Units:</label>
          <input type="number" id="revenueUnits" class="form-control" value="1000" step="any">
        </div>
        <div class="form-group">
          <label for="elasticityThresholdRev">Elasticity Threshold (Revenue Units):</label>
          <input type="number" id="elasticityThresholdRev" class="form-control" value="800" step="any">
        </div>
        <div class="form-group">
          <label for="elasticityFactorRev">Elasticity Factor (Revenue $ drop per unit beyond threshold):</label>
          <input type="number" id="elasticityFactorRev" class="form-control" value="0.03" step="any">
        </div>
      </div>
    </div>

    <!-- Cost Categories Section -->
    <div class="card section-card">
      <div class="card-header">Cost Categories</div>
      <div class="card-body">
        <p class="instruction">
          Enter the costs for each service category using a tiered discount model.
        </p>
        <!-- Compute Category -->
        <div class="card mb-3">
          <div class="card-header">Compute</div>
          <div class="card-body">
            <p class="instruction">Enter your compute costs (e.g., server hours). Tiered discounting applies based on usage thresholds.</p>
            <div class="form-row">
              <div class="form-group col-md-4">
                <label for="computeFixed">Fixed Cost ($):</label>
                <input type="number" id="computeFixed" class="form-control" value="500" step="any">
              </div>
              <div class="form-group col-md-4">
                <label for="computeVariable">Variable Cost per Unit ($):</label>
                <input type="number" id="computeVariable" class="form-control" value="0.15" step="any">
              </div>
              <div class="form-group col-md-4">
                <label for="computeUnits">Units (e.g., compute hours):</label>
                <input type="number" id="computeUnits" class="form-control" value="6000" step="any">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="computeTier1Threshold">Tier 1 Threshold:</label>
                <input type="number" id="computeTier1Threshold" class="form-control" value="4000" step="any">
              </div>
              <div class="form-group col-md-6">
                <label for="computeTier1Rate">Tier 1 Discount Rate (%):</label>
                <input type="number" id="computeTier1Rate" class="form-control" value="5" step="any">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="computeTier2Threshold">Tier 2 Threshold:</label>
                <input type="number" id="computeTier2Threshold" class="form-control" value="8000" step="any">
              </div>
              <div class="form-group col-md-6">
                <label for="computeTier2Rate">Tier 2 Discount Rate (%):</label>
                <input type="number" id="computeTier2Rate" class="form-control" value="10" step="any">
              </div>
            </div>
          </div>
        </div>
        <!-- Storage Category -->
        <div class="card mb-3">
          <div class="card-header">Storage</div>
          <div class="card-body">
            <p class="instruction">Enter your storage costs (e.g., GB used). Tiered discounting applies here as well.</p>
            <div class="form-row">
              <div class="form-group col-md-4">
                <label for="storageFixed">Fixed Cost ($):</label>
                <input type="number" id="storageFixed" class="form-control" value="300" step="any">
              </div>
              <div class="form-group col-md-4">
                <label for="storageVariable">Variable Cost per Unit ($):</label>
                <input type="number" id="storageVariable" class="form-control" value="0.05" step="any">
              </div>
              <div class="form-group col-md-4">
                <label for="storageUnits">Units (e.g., GB):</label>
                <input type="number" id="storageUnits" class="form-control" value="20000" step="any">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="storageTier1Threshold">Tier 1 Threshold:</label>
                <input type="number" id="storageTier1Threshold" class="form-control" value="15000" step="any">
              </div>
              <div class="form-group col-md-6">
                <label for="storageTier1Rate">Tier 1 Discount Rate (%):</label>
                <input type="number" id="storageTier1Rate" class="form-control" value="3" step="any">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="storageTier2Threshold">Tier 2 Threshold:</label>
                <input type="number" id="storageTier2Threshold" class="form-control" value="30000" step="any">
              </div>
              <div class="form-group col-md-6">
                <label for="storageTier2Rate">Tier 2 Discount Rate (%):</label>
                <input type="number" id="storageTier2Rate" class="form-control" value="7" step="any">
              </div>
            </div>
          </div>
        </div>
        <!-- Network Category -->
        <div class="card mb-3">
          <div class="card-header">Network</div>
          <div class="card-body">
            <p class="instruction">Enter your network costs (e.g., data transferred in GB). Discounts apply based on usage thresholds.</p>
            <div class="form-row">
              <div class="form-group col-md-4">
                <label for="networkFixed">Fixed Cost ($):</label>
                <input type="number" id="networkFixed" class="form-control" value="200" step="any">
              </div>
              <div class="form-group col-md-4">
                <label for="networkVariable">Variable Cost per Unit ($):</label>
                <input type="number" id="networkVariable" class="form-control" value="0.10" step="any">
              </div>
              <div class="form-group col-md-4">
                <label for="networkUnits">Units (e.g., GB transferred):</label>
                <input type="number" id="networkUnits" class="form-control" value="10000" step="any">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="networkTier1Threshold">Tier 1 Threshold:</label>
                <input type="number" id="networkTier1Threshold" class="form-control" value="8000" step="any">
              </div>
              <div class="form-group col-md-6">
                <label for="networkTier1Rate">Tier 1 Discount Rate (%):</label>
                <input type="number" id="networkTier1Rate" class="form-control" value="4" step="any">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="networkTier2Threshold">Tier 2 Threshold:</label>
                <input type="number" id="networkTier2Threshold" class="form-control" value="15000" step="any">
              </div>
              <div class="form-group col-md-6">
                <label for="networkTier2Rate">Tier 2 Discount Rate (%):</label>
                <input type="number" id="networkTier2Rate" class="form-control" value="8" step="any">
              </div>
            </div>
          </div>
        </div>
        <!-- License Category -->
        <div class="card mb-3">
          <div class="card-header">License</div>
          <div class="card-body">
            <p class="instruction">Enter your licensing costs (e.g., software seats). Discounts may apply when purchasing in volume.</p>
            <div class="form-row">
              <div class="form-group col-md-4">
                <label for="licenseFixed">Fixed Cost ($):</label>
                <input type="number" id="licenseFixed" class="form-control" value="400" step="any">
              </div>
              <div class="form-group col-md-4">
                <label for="licenseVariable">Variable Cost per Unit ($):</label>
                <input type="number" id="licenseVariable" class="form-control" value="1.00" step="any">
              </div>
              <div class="form-group col-md-4">
                <label for="licenseUnits">Units (e.g., seats):</label>
                <input type="number" id="licenseUnits" class="form-control" value="300" step="any">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="licenseTier1Threshold">Tier 1 Threshold:</label>
                <input type="number" id="licenseTier1Threshold" class="form-control" value="250" step="any">
              </div>
              <div class="form-group col-md-6">
                <label for="licenseTier1Rate">Tier 1 Discount Rate (%):</label>
                <input type="number" id="licenseTier1Rate" class="form-control" value="10" step="any">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-6">
                <label for="licenseTier2Threshold">Tier 2 Threshold:</label>
                <input type="number" id="licenseTier2Threshold" class="form-control" value="500" step="any">
              </div>
              <div class="form-group col-md-6">
                <label for="licenseTier2Rate">Tier 2 Discount Rate (%):</label>
                <input type="number" id="licenseTier2Rate" class="form-control" value="15" step="any">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Cloud Pricing Integration Section -->
    <div class="card section-card">
      <div class="card-header">Cloud Pricing Integration (Live)</div>
      <div class="card-body">
        <p class="instruction">
          Click the button below to fetch the latest live pricing data for compute, storage, and network services from AWS, Azure, and Google Cloud.
        </p>
        <button id="fetchCloudPrices" class="btn btn-primary mb-3">Fetch Latest Cloud Prices</button>
        <div id="cloudPricingResults" class="result" style="display:none;"></div>
      </div>
    </div>

    <!-- Forecasting Section -->
    <div class="card section-card">
      <div class="card-header">Forecasting (12‑Month Projection)</div>
      <div class="card-body">
        <p class="instruction">
          Enter your expected monthly growth rate to project revenue, costs, and profit over the next 12 months.
        </p>
        <div class="form-group">
          <label for="monthlyGrowth">Monthly Growth Rate (%):</label>
          <input type="number" id="monthlyGrowth" class="form-control" value="5" step="any">
        </div>
        <button id="runForecast" class="btn btn-success mb-3">Run Forecast</button>
        <canvas id="forecastChart" width="600" height="300" style="display:none;"></canvas>
      </div>
    </div>

    <!-- Deterministic Calculation Section -->
    <div class="card section-card">
      <div class="card-header">Deterministic Calculation &amp; Results</div>
      <div class="card-body">
        <p class="instruction">
          Click the button below to calculate deterministic metrics (total revenue, cost, profit, ROI) along with a detailed cost breakdown.
        </p>
        <button id="calculateBtn" class="btn btn-warning mb-3">Calculate Deterministic Metrics</button>
        <div id="deterministicResults" class="result" style="display:none;"></div>
        <canvas id="pieChart" width="400" height="200" style="display:none;"></canvas>
      </div>
    </div>

    <!-- Monte Carlo Simulation Section -->
    <div class="card section-card">
      <div class="card-header">Monte Carlo Simulation</div>
      <div class="card-body">
        <p class="instruction">
          Use this section to simulate uncertainty in your cost and revenue estimates. Adjust the variability percentages and number of iterations to model risk.
        </p>
        <div class="form-row">
          <div class="form-group col-md-4">
            <label for="simIterations">Simulation Iterations:</label>
            <input type="number" id="simIterations" class="form-control" value="1000" step="1">
          </div>
          <div class="form-group col-md-4">
            <label for="costVariability">Cost Variability (%):</label>
            <input type="number" id="costVariability" class="form-control" value="10" step="any">
          </div>
          <div class="form-group col-md-4">
            <label for="revenueVariability">Revenue Variability (%):</label>
            <input type="number" id="revenueVariability" class="form-control" value="10" step="any">
          </div>
        </div>
        <button id="runSimulation" class="btn btn-danger mb-3">Run Simulation</button>
        <div id="simulationResults" class="result" style="display:none;"></div>
        <canvas id="histogramChart" width="600" height="300" style="display:none;"></canvas>
      </div>
    </div>

    <!-- Sensitivity Analysis Section -->
    <div class="card section-card">
      <div class="card-header">Sensitivity Analysis</div>
      <div class="card-body">
        <p class="instruction">
          Examine how varying key parameters (such as the Compute Tier 1 discount rate) affects overall profitability. This analysis identifies the most sensitive cost drivers.
        </p>
        <button id="runSensitivity" class="btn btn-info mb-3">Run Sensitivity Analysis</button>
        <div id="sensitivityResults" class="result" style="display:none;"></div>
      </div>
    </div>

    <!-- Export Report Section -->
    <div class="card section-card">
      <div class="card-header">Export Report</div>
      <div class="card-body">
        <p class="instruction">
          Generate a professional PDF report summarizing your analysis—including key metrics and charts—for sharing with your team.
        </p>
        <button id="exportReportBtn" class="btn btn-secondary">Export Report as PDF</button>
      </div>
    </div>

    <!-- Official Pricing Links Section -->
    <div class="card section-card">
      <div class="card-header">Official Pricing Resources</div>
      <div class="card-body">
        <p>
          For the most accurate and up-to-date pricing information, refer directly to the official pricing pages of the major cloud providers:
        </p>
        <ul>
          <li><a href="https://aws.amazon.com/pricing/" target="_blank">AWS Pricing</a></li>
          <li><a href="https://azure.microsoft.com/en-us/pricing/" target="_blank">Azure Pricing</a></li>
          <li><a href="https://cloud.google.com/pricing" target="_blank">Google Cloud Pricing</a></li>
        </ul>
      </div>
    </div>

    <!-- Footer with Contact Info -->
    <footer>
      <p>For further inquiries, please reach out to <a href="mailto:info@tullyedmvibe.com">info@tullyedmvibe.com</a></p>
    </footer>
  </div>

  <!-- Dependencies: jQuery, Bootstrap JS, Chart.js, jsPDF -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    // ---------- Persistence: Save inputs to localStorage ----------
    function persistInputs() {
      const inputs = document.querySelectorAll('input[type="number"]');
      inputs.forEach(input => {
        const stored = localStorage.getItem(input.id);
        if (stored !== null) { input.value = stored; }
        input.addEventListener('change', () => { localStorage.setItem(input.id, input.value); });
      });
    }
    window.addEventListener('DOMContentLoaded', persistInputs);

    // ---------- Cloud Pricing Fetch Functions ----------
    // AWS Compute Pricing (example using t2.micro instance)
    async function fetchAWSComputePrice() {
      try {
        const response = await fetch('https://pricing.us-east-1.amazonaws.com/offers/v1.0/aws/AmazonEC2/current/index.json');
        const data = await response.json();
        const productKey = Object.keys(data.products).find(key => {
          return data.products[key].attributes && data.products[key].attributes.instanceType === 't2.micro';
        });
        let price = "N/A";
        if (productKey) {
          const onDemand = data.terms.OnDemand[productKey];
          if (onDemand) {
            const termKey = Object.keys(onDemand)[0];
            price = onDemand[termKey].priceDimensions[Object.keys(onDemand[termKey].priceDimensions)[0]].pricePerUnit.USD;
          }
        }
        return price;
      } catch(error) {
        console.error("AWS Compute fetch error:", error);
        return "Error";
      }
    }
    // AWS Storage Pricing (example using S3 Standard)
    async function fetchAWSStoragePrice() {
      try {
        const response = await fetch('https://pricing.us-east-1.amazonaws.com/offers/v1.0/aws/AmazonS3/current/index.json');
        const data = await response.json();
        const productKey = Object.keys(data.products).find(key => {
          return data.products[key].attributes && data.products[key].attributes.storageClass === 'Standard';
        });
        let price = "N/A";
        if (productKey) {
          const onDemand = data.terms.OnDemand[productKey];
          if (onDemand) {
            const termKey = Object.keys(onDemand)[0];
            price = onDemand[termKey].priceDimensions[Object.keys(onDemand[termKey].priceDimensions)[0]].pricePerUnit.USD;
          }
        }
        return price;
      } catch(error) {
        console.error("AWS Storage fetch error:", error);
        return "Error";
      }
    }
    // AWS Network Pricing (example using Data Transfer Out)
    async function fetchAWSNetworkPrice() {
      try {
        const response = await fetch('https://pricing.us-east-1.amazonaws.com/offers/v1.0/aws/AmazonEC2/current/index.json');
        const data = await response.json();
        const productKey = Object.keys(data.products).find(key => {
          return data.products[key].attributes && data.products[key].attributes.usageType && data.products[key].attributes.usageType.includes('DataTransfer-Out-Bytes');
        });
        let price = "N/A";
        if (productKey) {
          const onDemand = data.terms.OnDemand[productKey];
          if (onDemand) {
            const termKey = Object.keys(onDemand)[0];
            price = onDemand[termKey].priceDimensions[Object.keys(onDemand[termKey].priceDimensions)[0]].pricePerUnit.USD;
          }
        }
        return price;
      } catch(error) {
        console.error("AWS Network fetch error:", error);
        return "Error";
      }
    }
    document.getElementById('fetchCloudPrices').addEventListener('click', async () => {
      const resultsDiv = document.getElementById('cloudPricingResults');
      resultsDiv.style.display = 'block';
      resultsDiv.innerHTML = '<p>Fetching latest cloud pricing…</p>';
      try {
        const [awsCompute, awsStorage, awsNetwork] = await Promise.all([
          fetchAWSComputePrice(),
          fetchAWSStoragePrice(),
          fetchAWSNetworkPrice()
        ]);
        let html = '<h5>Latest Cloud Prices:</h5><table class="table table-bordered"><thead><tr><th>Category</th><th>AWS ($/unit)</th></tr></thead><tbody>';
        html += `<tr><td>Compute (t2.micro)</td><td>${awsCompute}</td></tr>`;
        html += `<tr><td>Storage (S3 Standard)</td><td>${awsStorage}</td></tr>`;
        html += `<tr><td>Network (Data Transfer Out)</td><td>${awsNetwork}</td></tr>`;
        html += '</tbody></table>';
        resultsDiv.innerHTML = html;
      } catch (error) {
        resultsDiv.innerHTML = '<p>Error fetching cloud pricing data.</p>';
      }
    });

    // ---------- Helper: Compute Category Cost with Tiered Discounts ----------
    function computeCategoryCost(units, baseCost, tier1Threshold, tier1Rate, tier2Threshold, tier2Rate) {
      let cost = 0;
      if (units <= tier1Threshold) {
        cost = units * baseCost;
      } else if (units <= tier2Threshold) {
        cost = tier1Threshold * baseCost + (units - tier1Threshold) * baseCost * (1 - tier1Rate/100);
      } else {
        cost = tier1Threshold * baseCost +
               (tier2Threshold - tier1Threshold) * baseCost * (1 - tier1Rate/100) +
               (units - tier2Threshold) * baseCost * (1 - tier2Rate/100);
      }
      return cost;
    }

    // ---------- Deterministic Calculation ----------
    document.getElementById('calculateBtn').addEventListener('click', () => {
      const overallFixedCost = parseFloat(document.getElementById('overallFixedCost').value);
      const revenuePerUnit = parseFloat(document.getElementById('revenuePerUnit').value);
      const revenueUnits = parseFloat(document.getElementById('revenueUnits').value);
      const elasticityThresholdRev = parseFloat(document.getElementById('elasticityThresholdRev').value);
      const elasticityFactorRev = parseFloat(document.getElementById('elasticityFactorRev').value);
      let effectiveRevenuePerUnit = revenuePerUnit;
      if (revenueUnits > elasticityThresholdRev) {
        effectiveRevenuePerUnit = Math.max(revenuePerUnit - elasticityFactorRev * (revenueUnits - elasticityThresholdRev), 0);
      }
      const totalRevenue = revenueUnits * effectiveRevenuePerUnit;

      const computeFixed = parseFloat(document.getElementById('computeFixed').value);
      const computeVariable = parseFloat(document.getElementById('computeVariable').value);
      const computeUnits = parseFloat(document.getElementById('computeUnits').value);
      const computeTier1Threshold = parseFloat(document.getElementById('computeTier1Threshold').value);
      const computeTier1Rate = parseFloat(document.getElementById('computeTier1Rate').value);
      const computeTier2Threshold = parseFloat(document.getElementById('computeTier2Threshold').value);
      const computeTier2Rate = parseFloat(document.getElementById('computeTier2Rate').value);
      const computeCost = computeFixed + computeCategoryCost(computeUnits, computeVariable, computeTier1Threshold, computeTier1Rate, computeTier2Threshold, computeTier2Rate);

      const storageFixed = parseFloat(document.getElementById('storageFixed').value);
      const storageVariable = parseFloat(document.getElementById('storageVariable').value);
      const storageUnits = parseFloat(document.getElementById('storageUnits').value);
      const storageTier1Threshold = parseFloat(document.getElementById('storageTier1Threshold').value);
      const storageTier1Rate = parseFloat(document.getElementById('storageTier1Rate').value);
      const storageTier2Threshold = parseFloat(document.getElementById('storageTier2Threshold').value);
      const storageTier2Rate = parseFloat(document.getElementById('storageTier2Rate').value);
      const storageCost = storageFixed + computeCategoryCost(storageUnits, storageVariable, storageTier1Threshold, storageTier1Rate, storageTier2Threshold, storageTier2Rate);

      const networkFixed = parseFloat(document.getElementById('networkFixed').value);
      const networkVariable = parseFloat(document.getElementById('networkVariable').value);
      const networkUnits = parseFloat(document.getElementById('networkUnits').value);
      const networkTier1Threshold = parseFloat(document.getElementById('networkTier1Threshold').value);
      const networkTier1Rate = parseFloat(document.getElementById('networkTier1Rate').value);
      const networkTier2Threshold = parseFloat(document.getElementById('networkTier2Threshold').value);
      const networkTier2Rate = parseFloat(document.getElementById('networkTier2Rate').value);
      const networkCost = networkFixed + computeCategoryCost(networkUnits, networkVariable, networkTier1Threshold, networkTier1Rate, networkTier2Threshold, networkTier2Rate);

      const licenseFixed = parseFloat(document.getElementById('licenseFixed').value);
      const licenseVariable = parseFloat(document.getElementById('licenseVariable').value);
      const licenseUnits = parseFloat(document.getElementById('licenseUnits').value);
      const licenseTier1Threshold = parseFloat(document.getElementById('licenseTier1Threshold').value);
      const licenseTier1Rate = parseFloat(document.getElementById('licenseTier1Rate').value);
      const licenseTier2Threshold = parseFloat(document.getElementById('licenseTier2Threshold').value);
      const licenseTier2Rate = parseFloat(document.getElementById('licenseTier2Rate').value);
      const licenseCost = licenseFixed + computeCategoryCost(licenseUnits, licenseVariable, licenseTier1Threshold, licenseTier1Rate, licenseTier2Threshold, licenseTier2Rate);

      const totalCost = overallFixedCost + computeCost + storageCost + networkCost + licenseCost;
      const profit = totalRevenue - totalCost;
      const profitMargin = totalRevenue ? (profit / totalRevenue * 100).toFixed(2) : "N/A";
      const roi = totalCost ? (profit / totalCost * 100).toFixed(2) : "N/A";

      const resultsDiv = document.getElementById('deterministicResults');
      resultsDiv.style.display = 'block';
      resultsDiv.innerHTML = `
        <h5>Deterministic Results</h5>
        <p><strong>Total Revenue:</strong> $${totalRevenue.toFixed(2)}</p>
        <p><strong>Total Cost:</strong> $${totalCost.toFixed(2)}</p>
        <p><strong>Profit:</strong> $${profit.toFixed(2)}</p>
        <p><strong>Profit Margin:</strong> ${profitMargin}%</p>
        <p><strong>ROI:</strong> ${roi}%</p>
        <h6>Cost Breakdown:</h6>
        <p>Compute: $${computeCost.toFixed(2)}, Storage: $${storageCost.toFixed(2)}, Network: $${networkCost.toFixed(2)}, License: $${licenseCost.toFixed(2)}</p>
      `;

      const pieCtx = document.getElementById('pieChart').getContext('2d');
      document.getElementById('pieChart').style.display = 'block';
      if (window.myPieChart) window.myPieChart.destroy();
      window.myPieChart = new Chart(pieCtx, {
        type: 'pie',
        data: {
          labels: ['Compute', 'Storage', 'Network', 'License'],
          datasets: [{
            data: [computeCost, storageCost, networkCost, licenseCost],
            backgroundColor: ['rgba(255, 99, 132, 0.6)', 'rgba(54, 162, 235, 0.6)', 'rgba(255, 206, 86, 0.6)', 'rgba(75, 192, 192, 0.6)']
          }]
        },
        options: { plugins: { legend: { position: 'bottom' } } }
      });
    });

    // ---------- Forecasting (12‑Month Projection) ----------
    document.getElementById('runForecast').addEventListener('click', () => {
      const months = 12;
      const monthlyGrowth = parseFloat(document.getElementById('monthlyGrowth').value) / 100;
      const overallFixedCost = parseFloat(document.getElementById('overallFixedCost').value);
      const revenuePerUnit = parseFloat(document.getElementById('revenuePerUnit').value);
      const revenueUnits = parseFloat(document.getElementById('revenueUnits').value);
      const elasticityThresholdRev = parseFloat(document.getElementById('elasticityThresholdRev').value);
      const elasticityFactorRev = parseFloat(document.getElementById('elasticityFactorRev').value);

      function getBaselineCost(idPrefix) {
        const fixed = parseFloat(document.getElementById(idPrefix + 'Fixed').value);
        const variable = parseFloat(document.getElementById(idPrefix + 'Variable').value);
        const units = parseFloat(document.getElementById(idPrefix + 'Units').value);
        const tier1Threshold = parseFloat(document.getElementById(idPrefix + 'Tier1Threshold').value);
        const tier1Rate = parseFloat(document.getElementById(idPrefix + 'Tier1Rate').value);
        const tier2Threshold = parseFloat(document.getElementById(idPrefix + 'Tier2Threshold').value);
        const tier2Rate = parseFloat(document.getElementById(idPrefix + 'Tier2Rate').value);
        return fixed + computeCategoryCost(units, variable, tier1Threshold, tier1Rate, tier2Threshold, tier2Rate);
      }
      const computeCostBase = getBaselineCost('compute');
      const storageCostBase = getBaselineCost('storage');
      const networkCostBase = getBaselineCost('network');
      const licenseCostBase = getBaselineCost('license');
      const overallCostBase = overallFixedCost + computeCostBase + storageCostBase + networkCostBase + licenseCostBase;

      let forecastMonths = [];
      let forecastRevenue = [];
      let forecastCost = [];
      let forecastProfit = [];

      let currentRevenueUnits = revenueUnits;
      let currentOverallCost = overallCostBase;
      for (let m = 0; m <= months; m++) {
        let effectiveRevenuePerUnit = revenuePerUnit;
        if (currentRevenueUnits > elasticityThresholdRev) {
          effectiveRevenuePerUnit = Math.max(revenuePerUnit - elasticityFactorRev * (currentRevenueUnits - elasticityThresholdRev), 0);
        }
        const totalRev = currentRevenueUnits * effectiveRevenuePerUnit;
        forecastMonths.push("Month " + m);
        forecastRevenue.push(totalRev);
        forecastCost.push(currentOverallCost);
        forecastProfit.push(totalRev - currentOverallCost);

        currentRevenueUnits *= (1 + monthlyGrowth);
        currentOverallCost *= (1 + monthlyGrowth);
      }

      const forecastCtx = document.getElementById('forecastChart').getContext('2d');
      document.getElementById('forecastChart').style.display = 'block';
      if (window.myForecastChart) window.myForecastChart.destroy();
      window.myForecastChart = new Chart(forecastCtx, {
        type: 'line',
        data: {
          labels: forecastMonths,
          datasets: [
            { label: 'Revenue', data: forecastRevenue, borderColor: 'rgba(75, 192, 192, 1)', fill: false },
            { label: 'Cost', data: forecastCost, borderColor: 'rgba(255, 99, 132, 1)', fill: false },
            { label: 'Profit', data: forecastProfit, borderColor: 'rgba(54, 162, 235, 1)', fill: false }
          ]
        },
        options: {
          plugins: { legend: { position: 'bottom' } },
          scales: { y: { beginAtZero: true } }
        }
      });
    });

    // ---------- Monte Carlo Simulation ----------
    document.getElementById('runSimulation').addEventListener('click', () => {
      const simIterations = parseInt(document.getElementById('simIterations').value);
      const costVariability = parseFloat(document.getElementById('costVariability').value) / 100;
      const revenueVariability = parseFloat(document.getElementById('revenueVariability').value) / 100;
      const revenuePerUnit = parseFloat(document.getElementById('revenuePerUnit').value);
      const revenueUnits = parseFloat(document.getElementById('revenueUnits').value);
      const elasticityThresholdRev = parseFloat(document.getElementById('elasticityThresholdRev').value);
      const elasticityFactorRev = parseFloat(document.getElementById('elasticityFactorRev').value);
      const overallFixedCost = parseFloat(document.getElementById('overallFixedCost').value);

      function getCategoryInputs(idPrefix) {
        return {
          fixed: parseFloat(document.getElementById(idPrefix + 'Fixed').value),
          variable: parseFloat(document.getElementById(idPrefix + 'Variable').value),
          units: parseFloat(document.getElementById(idPrefix + 'Units').value),
          tier1Threshold: parseFloat(document.getElementById(idPrefix + 'Tier1Threshold').value),
          tier1Rate: parseFloat(document.getElementById(idPrefix + 'Tier1Rate').value),
          tier2Threshold: parseFloat(document.getElementById(idPrefix + 'Tier2Threshold').value),
          tier2Rate: parseFloat(document.getElementById(idPrefix + 'Tier2Rate').value)
        };
      }
      const computeInputs = getCategoryInputs('compute');
      const storageInputs = getCategoryInputs('storage');
      const networkInputs = getCategoryInputs('network');
      const licenseInputs = getCategoryInputs('license');

      function getRandomNormal() {
        let u = 0, v = 0;
        while(u === 0) u = Math.random();
        while(v === 0) v = Math.random();
        return Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
      }

      const simulationProfits = [];
      for (let i = 0; i < simIterations; i++) {
        const costMultiplier = 1 + getRandomNormal() * costVariability;
        const revenueMultiplier = 1 + getRandomNormal() * revenueVariability;

        const simComputeCost = computeInputs.fixed + computeCategoryCost(computeInputs.units, computeInputs.variable * costMultiplier, computeInputs.tier1Threshold, computeInputs.tier1Rate, computeInputs.tier2Threshold, computeInputs.tier2Rate);
        const simStorageCost = storageInputs.fixed + computeCategoryCost(storageInputs.units, storageInputs.variable * costMultiplier, storageInputs.tier1Threshold, storageInputs.tier1Rate, storageInputs.tier2Threshold, storageInputs.tier2Rate);
        const simNetworkCost = networkInputs.fixed + computeCategoryCost(networkInputs.units, networkInputs.variable * costMultiplier, networkInputs.tier1Threshold, networkInputs.tier1Rate, networkInputs.tier2Threshold, networkInputs.tier2Rate);
        const simLicenseCost = licenseInputs.fixed + computeCategoryCost(licenseInputs.units, licenseInputs.variable * costMultiplier, licenseInputs.tier1Threshold, licenseInputs.tier1Rate, licenseInputs.tier2Threshold, licenseInputs.tier2Rate);
        const totalSimCost = overallFixedCost + simComputeCost + simStorageCost + simNetworkCost + simLicenseCost;

        let simEffectiveRevenue = revenuePerUnit * revenueMultiplier;
        if (revenueUnits > elasticityThresholdRev) {
          simEffectiveRevenue = Math.max(revenuePerUnit * revenueMultiplier - elasticityFactorRev * (revenueUnits - elasticityThresholdRev), 0);
        }
        const totalSimRevenue = revenueUnits * simEffectiveRevenue;
        simulationProfits.push(totalSimRevenue - totalSimCost);
      }

      const sumProfit = simulationProfits.reduce((a, b) => a + b, 0);
      const avgProfit = sumProfit / simulationProfits.length;
      const minProfit = Math.min(...simulationProfits);
      const maxProfit = Math.max(...simulationProfits);
      const stdProfit = Math.sqrt(simulationProfits.reduce((a, b) => a + Math.pow(b - avgProfit, 2), 0) / simulationProfits.length);

      const numBins = 10;
      const profitRange = maxProfit - minProfit;
      const binSize = profitRange / numBins;
      const bins = new Array(numBins).fill(0);
      const binLabels = [];
      simulationProfits.forEach(profit => {
        let binIndex = Math.floor((profit - minProfit) / binSize);
        if (binIndex === numBins) binIndex = numBins - 1;
        bins[binIndex]++;
      });
      for (let i = 0; i < numBins; i++) {
        const binCenter = minProfit + binSize * (i + 0.5);
        binLabels.push(binCenter.toFixed(2));
      }

      const simResultsDiv = document.getElementById('simulationResults');
      simResultsDiv.style.display = 'block';
      simResultsDiv.innerHTML = `
        <h5>Simulation Summary (over ${simIterations} iterations):</h5>
        <p>Average Profit: $${avgProfit.toFixed(2)}</p>
        <p>Minimum Profit: $${minProfit.toFixed(2)}</p>
        <p>Maximum Profit: $${maxProfit.toFixed(2)}</p>
        <p>Standard Deviation: $${stdProfit.toFixed(2)}</p>
      `;

      const histCtx = document.getElementById('histogramChart').getContext('2d');
      document.getElementById('histogramChart').style.display = 'block';
      if (window.myHistChart) window.myHistChart.destroy();
      window.myHistChart = new Chart(histCtx, {
        type: 'bar',
        data: {
          labels: binLabels,
          datasets: [{
            label: 'Profit Frequency',
            data: bins,
            backgroundColor: 'rgba(153, 102, 255, 0.6)'
          }]
        },
        options: { plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
      });
    });

    // ---------- Sensitivity Analysis ----------
    document.getElementById('runSensitivity').addEventListener('click', () => {
      const baseRate = parseFloat(document.getElementById('computeTier1Rate').value);
      const sensitivityData = [];
      const sensitivityLabels = [];
      for (let delta = -5; delta <= 5; delta += 1) {
        const testRate = baseRate + delta;
        const computeFixed = parseFloat(document.getElementById('computeFixed').value);
        const computeVariable = parseFloat(document.getElementById('computeVariable').value);
        const computeUnits = parseFloat(document.getElementById('computeUnits').value);
        const computeTier1Threshold = parseFloat(document.getElementById('computeTier1Threshold').value);
        const computeTier2Threshold = parseFloat(document.getElementById('computeTier2Threshold').value);
        const computeTier2Rate = parseFloat(document.getElementById('computeTier2Rate').value);
        const modifiedComputeCost = computeFixed + computeCategoryCost(computeUnits, computeVariable, computeTier1Threshold, testRate, computeTier2Threshold, computeTier2Rate);

        const overallFixedCost = parseFloat(document.getElementById('overallFixedCost').value);
        const storageCost = parseFloat(document.getElementById('storageFixed').value) + computeCategoryCost(
          parseFloat(document.getElementById('storageUnits').value),
          parseFloat(document.getElementById('storageVariable').value),
          parseFloat(document.getElementById('storageTier1Threshold').value),
          parseFloat(document.getElementById('storageTier1Rate').value),
          parseFloat(document.getElementById('storageTier2Threshold').value),
          parseFloat(document.getElementById('storageTier2Rate').value)
        );
        const networkCost = parseFloat(document.getElementById('networkFixed').value) + computeCategoryCost(
          parseFloat(document.getElementById('networkUnits').value),
          parseFloat(document.getElementById('networkVariable').value),
          parseFloat(document.getElementById('networkTier1Threshold').value),
          parseFloat(document.getElementById('networkTier1Rate').value),
          parseFloat(document.getElementById('networkTier2Threshold').value),
          parseFloat(document.getElementById('networkTier2Rate').value)
        );
        const licenseCost = parseFloat(document.getElementById('licenseFixed').value) + computeCategoryCost(
          parseFloat(document.getElementById('licenseUnits').value),
          parseFloat(document.getElementById('licenseVariable').value),
          parseFloat(document.getElementById('licenseTier1Threshold').value),
          parseFloat(document.getElementById('licenseTier1Rate').value),
          parseFloat(document.getElementById('licenseTier2Threshold').value),
          parseFloat(document.getElementById('licenseTier2Rate').value)
        );

        const revenuePerUnit = parseFloat(document.getElementById('revenuePerUnit').value);
        const revenueUnits = parseFloat(document.getElementById('revenueUnits').value);
        const elasticityThresholdRev = parseFloat(document.getElementById('elasticityThresholdRev').value);
        const elasticityFactorRev = parseFloat(document.getElementById('elasticityFactorRev').value);
        let effectiveRevenuePerUnit = revenuePerUnit;
        if (revenueUnits > elasticityThresholdRev) {
          effectiveRevenuePerUnit = Math.max(revenuePerUnit - elasticityFactorRev * (revenueUnits - elasticityThresholdRev), 0);
        }
        const totalRevenue = revenueUnits * effectiveRevenuePerUnit;
        const totalCost = overallFixedCost + modifiedComputeCost + storageCost + networkCost + licenseCost;
        const profit = totalRevenue - totalCost;
        sensitivityData.push(profit);
        sensitivityLabels.push(testRate.toFixed(2) + "%");
      }

      const sensitivityResultsDiv = document.getElementById('sensitivityResults');
      sensitivityResultsDiv.style.display = 'block';
      let tableHTML = '<h5>Sensitivity Analysis: Profit vs. Compute Tier 1 Discount Rate</h5><table class="table table-sm table-bordered"><thead><tr><th>Tier 1 Discount Rate</th><th>Profit ($)</th></tr></thead><tbody>';
      for (let i = 0; i < sensitivityLabels.length; i++) {
        tableHTML += `<tr><td>${sensitivityLabels[i]}</td><td>${sensitivityData[i].toFixed(2)}</td></tr>`;
      }
      tableHTML += '</tbody></table>';
      sensitivityResultsDiv.innerHTML = tableHTML;
    });

    // ---------- Export Report as PDF ----------
    async function exportReport() {
      const deterministicHTML = document.getElementById('deterministicResults').innerText;
      const simulationHTML = document.getElementById('simulationResults').innerText;
      const sensitivityHTML = document.getElementById('sensitivityResults').innerText;
      const forecastCanvas = document.getElementById('forecastChart');

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFontSize(16);
      doc.text("FinOps Analysis Report", 10, 15);
      doc.setFontSize(12);
      doc.text("Deterministic Metrics:", 10, 25);
      doc.text(deterministicHTML, 10, 35);

      let yPos = 60;
      doc.text("Monte Carlo Simulation Summary:", 10, yPos);
      yPos += 10;
      doc.text(simulationHTML, 10, yPos);

      yPos += 20;
      doc.text("Sensitivity Analysis:", 10, yPos);
      yPos += 10;
      doc.text(sensitivityHTML, 10, yPos);

      if (forecastCanvas && forecastCanvas.style.display !== 'none') {
        const imgData = forecastCanvas.toDataURL("image/png");
        yPos += 30;
        doc.text("12‑Month Forecast Chart:", 10, yPos);
        yPos += 10;
        doc.addImage(imgData, 'PNG', 10, yPos, 180, 80);
      }

      doc.save("FinOps_Report.pdf");
    }
    document.getElementById('exportReportBtn').addEventListener('click', exportReport);
  </script>
</body>
</html>
